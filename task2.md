Этап 2
Ваши коллеги решили лучше изучить поведение клиентов. Для этого они хотят исследовать возвращаемость клиентов, или customer retention. 
Выяснилось, что на текущий момент отчёт по customer retention строится очень долго. Коллеги попросили вас вычислить нужные метрики в дополнительной витрине.
Эта витрина должна отражать следующую информацию:

    Рассматриваемый период — weekly.
    Возвращаемость клиентов:
      
        new — кол-во клиентов, которые оформили один заказ за рассматриваемый период;
        returning — кол-во клиентов, которые оформили более одного заказа за рассматриваемый период;
        refunded — кол-во клиентов, которые вернули заказ за рассматриваемый период.
    Доход (revenue) и refunded для каждой категории покупателей.

Благодаря витрине можно будет выяснить, какие категории товаров лучше всего удерживают клиентов.
Коллеги подготовили для вас схему витрины mart.f_customer_retention:

mart.f_customer_retention
1. new_customers_count — кол-во новых клиентов (тех, которые сделали только один 
заказ за рассматриваемый промежуток времени).
2. returning_customers_count — кол-во вернувшихся клиентов (тех,
которые сделали только несколько заказов за рассматриваемый промежуток времени).
3. refunded_customer_count — кол-во клиентов, оформивших возврат за 
рассматриваемый промежуток времени.
4. period_name — weekly.
5. period_id — идентификатор периода (номер недели или номер месяца).
6. item_id — идентификатор категории товара.
7. new_customers_revenue — доход с новых клиентов.
8. returning_customers_revenue — доход с вернувшихся клиентов.
9. customers_refunded — количество возвратов клиентов. 

Ваша задача
На основе пайплайна из сквозной задачи спринта наполните витрину mart.f_customer_retention данными по «возвращаемости клиентов» в разрезе недель.
